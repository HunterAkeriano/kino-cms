import{a4 as L,x as g,J as R,s as y,v as k,e as B,r as S,o as n,g as a,u as l,n as O,m as i,h as e,y as r,a1 as _,i as x,j as w,t as m,H as D,F as U,k as F,D as H}from"./index-4501b78c.js";const N=e("h2",null,"Рассылка",-1),j={class:"card",style:{padding:"20px"}},I=e("h3",{style:{"text-align":"center"}},"SMS",-1),z={class:"users"},A={class:"width"},J=e("h5",null,"Выберите кому слать сообщения",-1),P={class:"user",style:{display:"flex",gap:"40px"}},$={class:"block"},q=e("label",{style:{margin:"0"},for:"one"},"Все пользователи",-1),G={class:"block"},K=e("label",{style:{margin:"0"},for:"two"},"Выбрать пользователей",-1),Q={key:0},W={class:"out"},X={key:0,class:"one"},Y={key:1,class:"two"},Z={class:"text mt-5"},ee=e("h5",null,"Текст смс",-1),te=["disabled"],se={class:"card mt-5",style:{padding:"20px"}},le=e("h3",{style:{"text-align":"center"}},"Email",-1),oe={class:"users"},ne={class:"width"},ae=e("h5",null,"Выберите кому слать сообщения",-1),ie={class:"user",style:{display:"flex",gap:"40px"}},de={class:"block"},ue=e("label",{style:{margin:"0"},for:"emailOne"},"Все пользователи",-1),ce={class:"block"},re=e("label",{style:{margin:"0"},for:"emailTwo"},"Выбрать пользователей",-1),_e={key:0},me={class:"out"},he={key:0,class:"one"},ve={key:1,class:"two"},pe={class:"text mt-5"},be={class:"block"},fe=e("label",{style:{margin:"0"},for:"shablonOne"},"Новый шаблон",-1),ge={class:"block"},ye={key:0,class:"new-email mt-5"},ke=e("h5",null,"Загрузить новое письмо",-1),Se={key:0,class:"block-input"},xe={key:1,class:"old-email mt-5"},we=e("h5",null,"Выберите шаблон",-1),Ue={class:"card"},Ce={class:"info"},Ee={class:"table-responsive mt-3"},Ve={class:"table table-striped table-bordered table-hover"},Me=e("tr",null,[e("td",null,"Выбранное"),e("td",null,"Имя документа")],-1),Te=["onUpdate:modelValue"],Le=["href"],Oe={__name:"Mail",setup(Re){const t=L(),d=g(""),b=g(50);R(()=>{t.getHtml()});const f=y({value:null});k(()=>{f.value=t.allUserSMS.length});const v=y({value:null});k(()=>{v.value=t.allUserSMS.filter(u=>u.status===!0).length});function C(){d.value.length>b.value&&(d.value=d.value.substring(0,b.value))}const E=B(()=>b.value-d.value.length);function V(){t.selectSms=="1"&&v.value==0||(t.loading=!0,setTimeout(()=>{t.allUserSMS.forEach(u=>{u.status=!1}),d.value="",t.loading=!1},5e3))}async function M(u){const o=u.target.files;for(let h=0;h<o.length;h++){const c=o[h];if(c.type==="text/html"){const s=new FileReader;await new Promise(p=>{s.onload=p,s.onerror=p,s.readAsDataURL(c)}),t.documents.splice(0,1,{id:0,name:c.name,image:c,url:URL.createObjectURL(c)})}}}function T(){t.documents.length==0&&t.selectShablon=="0"||(t.addHtml(),t.selectShablon=="1"&&(t.loading=!0,setTimeout(()=>{t.loading=!1,t.shablons.forEach(u=>{u.status=!1})},5e3)))}return(u,o)=>{const h=S("Loader"),c=S("router-link");return n(),a(U,null,[l(t).loading?(n(),O(h,{key:0})):i("",!0),N,e("div",j,[I,e("div",z,[e("div",A,[J,e("div",P,[e("div",$,[q,r(e("input",{"onUpdate:modelValue":o[0]||(o[0]=s=>l(t).selectSms=s),id:"one",type:"radio",name:"user",value:"0"},null,512),[[_,l(t).selectSms]])]),e("div",G,[K,r(e("input",{"onUpdate:modelValue":o[1]||(o[1]=s=>l(t).selectSms=s),id:"two",type:"radio",name:"user",value:"1"},null,512),[[_,l(t).selectSms]])]),x(c,{to:"mail-sms"},{default:w(()=>[l(t).selectSms=="1"?(n(),a("button",Q,"Выбрать пользователей")):i("",!0)]),_:1})]),e("div",W,[l(t).selectSms=="0"?(n(),a("div",X,[e("h6",null,"Выбрано: "+m(f.value),1)])):i("",!0),l(t).selectSms=="1"?(n(),a("div",Y,[e("h6",null,"Выбрано: "+m(v.value),1)])):i("",!0)])])]),e("div",Z,[ee,r(e("textarea",{style:{resize:"none",width:"100%"},"onUpdate:modelValue":o[2]||(o[2]=s=>d.value=s),onInput:C},null,544),[[D,d.value]]),e("p",null,"Количество символов которое осталось: "+m(l(E)),1)]),e("button",{onClick:V,disabled:d.value.length<1,class:"btn btn-block btn-success"},"Отправить",8,te)]),e("div",se,[le,e("div",oe,[e("div",ne,[ae,e("div",ie,[e("div",de,[ue,r(e("input",{"onUpdate:modelValue":o[3]||(o[3]=s=>l(t).selectEmail=s),id:"emailOne",type:"radio",name:"email",value:"0"},null,512),[[_,l(t).selectEmail]])]),e("div",ce,[re,r(e("input",{"onUpdate:modelValue":o[4]||(o[4]=s=>l(t).selectEmail=s),id:"emailTwo",type:"radio",name:"email",value:"1"},null,512),[[_,l(t).selectEmail]])]),x(c,{to:"mail-sms"},{default:w(()=>[l(t).selectEmail=="1"?(n(),a("button",_e,"Выбрать пользователей")):i("",!0)]),_:1})]),e("div",me,[l(t).selectEmail=="0"?(n(),a("div",he,[e("h6",null,"Выбрано: "+m(f.value),1)])):i("",!0),l(t).selectEmail=="1"?(n(),a("div",ve,[e("h6",null,"Выбрано: "+m(v.value),1)])):i("",!0)])])]),e("div",pe,[e("div",be,[fe,r(e("input",{"onUpdate:modelValue":o[5]||(o[5]=s=>l(t).selectShablon=s),id:"shablonOne",type:"radio",name:"shablon",value:"0"},null,512),[[_,l(t).selectShablon]])]),e("div",ge,[e("label",{onClick:o[6]||(o[6]=s=>l(t).documents=[]),style:{margin:"0"},for:"shablonTwo"},"Старый шаблон"),r(e("input",{"onUpdate:modelValue":o[7]||(o[7]=s=>l(t).selectShablon=s),id:"shablonTwo",type:"radio",name:"shablon",value:"1"},null,512),[[_,l(t).selectShablon]])]),l(t).selectShablon=="0"?(n(),a("div",ye,[ke,l(t).selectShablons=="0"?(n(),a("div",Se,[e("input",{onChange:o[8]||(o[8]=s=>M(s)),class:"img-top-input",id:"img-top",ref:"fileInput",type:"file",accept:"text/html"},null,544)])):i("",!0)])):i("",!0),l(t).selectShablon=="1"?(n(),a("div",xe,[we,e("div",Ue,[e("div",Ce,[e("div",Ee,[e("table",Ve,[e("tbody",null,[Me,(n(!0),a(U,null,F(l(t).shablons,s=>(n(),a("tr",null,[e("td",null,[r(e("input",{type:"checkbox","onUpdate:modelValue":p=>s.status=p},null,8,Te),[[H,s.status]])]),e("td",null,[e("a",{href:s.url,target:"_blank"},m(s.name),9,Le)])]))),256))])])])])])])):i("",!0)]),e("button",{onClick:T,class:"btn btn-block btn-success mt-5"},"Отправить")])],64)}}};export{Oe as default};
