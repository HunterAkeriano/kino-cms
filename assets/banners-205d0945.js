import{l,m as t,q as m,s as o,u as r,x as d,y as h}from"./index-2dc2f4b0.js";const c=l({id:"banners",state:()=>({movieBanners:{data:[],banners:[],deletedBanners:[],rotationSpeed:0},url:"",text:"",name:"banner-"}),actions:{async getImages(){const n=t(r,"banners/top/");try{(await m(n)).items.forEach(async a=>{const s=await o(a),i=decodeURIComponent(s).split("/").pop().split("?")[0];this.movieBanners.banners.push({id:i,uploaded:!0,image:null,url:s}),this.movieBanners.data.push({url:s,name:i})})}catch(e){console.log(e)}},deleteMovieBanner(n){this.movieBanners.banners[n].uploaded&&this.movieBanners.deletedBanners.push(this.movieBanners.data[n].name),this.movieBanners.banners.splice(n,1),this.movieBanners.data.splice(n,1);for(let e=0;e<this.movieBanners.data.length;e++)this.movieBanners.data[e].id!==e&&this.movieBanners.banners[e].id!==e&&(this.movieBanners.data[e].id=this.movieBanners.banners[e].id=e)},async uploadMovieBanners(){if(this.loading=!0,this.movieBanners.deletedBanners.length!==0){const n=[];for(let e=0;e<this.movieBanners.deletedBanners.length;e++){const a=t(r,"banners/top/"+this.movieBanners.deletedBanners[e]);n.push(d(a))}await Promise.all(n).then(()=>{console.log("Все выбранные файлы удалены успешно."),this.movieBanners.deletedBanners=[]}).catch(e=>{console.error("Ошибка удаления файлов:",e)})}for(let n=0;n<this.movieBanners.banners.length;n++)if(this.movieBanners.banners[n].image!==null)try{const e=t(r,"banners/top/"+this.movieBanners.data[n].name);await h(e,this.movieBanners.banners[n].image).then(async()=>{await o(e).then(a=>{this.movieBanners.data[n].image=a})})}catch(e){console.error("Error uploading banners: ",e)}await new Promise(n=>setTimeout(n,100))}}});export{c as b};
